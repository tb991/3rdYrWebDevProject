<html>
<head>
<script>
var mouseheld = false;
var exampleSocket = new WebSocket("ws://192.168.1.102:9000");
var brushSize = 10;
function send(event){
	if(mouseheld){
		exampleSocket.send(event.clientX + "," + event.clientY + "," + brushSize);
	}
}
function setUp(){
	mouseheld = false;
	//console.log("mouse up")
}
function setDown(){
	mouseheld = true;
	//console.log("mouse down")
}
exampleSocket.onmessage = e => {
	//console.log(e.data)
	var paintDetails = e.data.split(",");
	x = paintDetails[0];
	y = paintDetails[1];
	brushSize = paintDetails[2];
	//console.log(x + "," + y);
	var cv = document.getElementById("publicCanvas");
	var ctx = cv.getContext("2d");
	var rect = cv.getBoundingClientRect();
	var rgb = "black";
	ctx.beginPath();
	var xLoc = x - rect.left;
	var yLoc = y - rect.top;
	ctx.arc(xLoc,yLoc,brushSize,0,2*Math.PI);
	ctx.fillStyle=rgb;
	ctx.fill();
	
	if (x==9999 && y==9999){
		// then someone cleared the screen; so clear the screen
		ctx.clearRect(0, 0, cv.width, cv.height);
	}
}
function test(event){
	exampleSocket.send(event.touches[0].clientX + "," + event.touches[0].clientY + "," + brushSize);
}
// request a (for now global) clearscreen from the server
function reqClear(){
	exampleSocket.send("9999,9999"); // code for "clear the screen globally"
}
function changeBrushSize(){
	brushSize = event.srcElement.value;
}
</script>
</head>
<body>
<!--            CANVAS           -->
<canvas id="publicCanvas" width="800" height="600" style="border:1px solid #000000;" onmousedown="setDown()" onmouseup="setUp()" onmousemove="send(event)" ontouchmove="test(event)"></canvas>
<br />
<!--            CONTROLS         -->
<button id="clearBtn" onclick="reqClear()">Clear</button>
<button id="brushBtn">Brush</button>
<button id="eraserBtn">Eraser</button>
R:<input id="red" type="number" min="0" max="255" value="0"/>
G:<input id="green" type="number" min="0" max="255" value="0"/>
B:<input id="blue" type="number" min="0" max="255" value="0"/>
<input id="slider" type="range" min="1" max="50" value="25" onchange="changeBrushSize(event)">
</body>
</html>

